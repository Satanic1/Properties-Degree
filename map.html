<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ä—Ç–∞ –ö–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–∞ –°—Ç–µ–ø–µ–Ω–Ω–æ–π –ú–∞–≥–∏–∏</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .map-visual {
            position: relative;
            width: 800px;
            height: 600px;
            margin: 40px auto;
            background: 
                radial-gradient(circle at 20% 20%, rgba(138, 43, 226, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 30%, rgba(75, 0, 130, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 70%, rgba(123, 104, 238, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 70% 80%, rgba(186, 85, 211, 0.3) 0%, transparent 50%),
                linear-gradient(135deg, #4B0082 0%, #8A2BE2 100%);
            border-radius: 20px;
            border: 3px solid #FFD700;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
        }
        
        .province {
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            font-size: 1.5em;
            color: white;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .province:hover {
            transform: scale(1.15);
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.5);
        }
        
        .province.completed {
            background: rgba(46, 204, 113, 0.3);
            border-color: #2ecc71;
        }
        
        .province.locked {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .province.current {
            animation: pulse 2s infinite;
            box-shadow: 0 0 0 5px rgba(255, 215, 0, 0.5);
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(255, 215, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); }
        }
        
        .province-number {
            font-size: 2em;
        }
        
        .province-operation {
            font-size: 1.2em;
            margin-top: 5px;
        }
        
        .path {
            position: absolute;
            background: rgba(255, 215, 0, 0.5);
            height: 5px;
            transform-origin: 0 0;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .path.visible {
            opacity: 1;
        }
        
        .completion-message {
            background: rgba(46, 204, 113, 0.2);
            border: 2px solid #2ecc71;
            border-radius: 15px;
            padding: 20px;
            margin: 30px auto;
            max-width: 600px;
            text-align: center;
            animation: fadeIn 1s;
            display: none;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .start-info {
            background: rgba(255, 215, 0, 0.1);
            border: 2px solid #FFD700;
            border-radius: 15px;
            padding: 20px;
            margin: 30px auto;
            max-width: 600px;
            text-align: center;
        }
        
        .order-hint {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        
        .order-step {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .order-step.current {
            background: #FFD700;
            color: #4B0082;
        }
        
        .power-law {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-family: "Cambria Math", serif;
            font-size: 1.1em;
        }
        
        .header-controls {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: flex-end; /* –∫–Ω–æ–ø–∫–∏ —Å–ø—Ä–∞–≤–∞ */
            align-items: center;
            z-index: 100;
        }
        
        .control-buttons {
            display: flex;
            gap: 10px;
            margin-right: 20px; /* –æ—Ç—Å—Ç—É–ø –æ—Ç –ø—Ä–∞–≤–æ–≥–æ –∫—Ä–∞—è */
        }
        
        .control-btn {
            background: rgba(231, 76, 60, 0.2);
            color: black;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
        }
        
        .control-btn:hover {
            background: rgba(231, 76, 60, 0.3);
        }
        
        .control-btn.restart {
            background: rgba(231, 76, 60, 0.2);
            color: black;
        }
        
        .control-btn.restart:hover {
            background: rgba(231, 76, 60, 0.3);
            transform: scale(1.05);
        }
        
        .paths-legend {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid #FFD700;
            border-radius: 10px;
            padding: 15px;
            margin: 20px auto;
            max-width: 600px;
            text-align: center;
        }

        /* –Ω–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
        .progress-bar {
            margin-top: 40px; /* –æ–ø—É—Å–∫–∞–µ–º –Ω–∏–∂–µ */
        }

        .progress-text {
            font-size: 1.5em;
            margin-bottom: 20px;
            font-weight: bold;
            color: #FFD700;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-controls">
            <div class="control-buttons">
                <button class="control-btn" onclick="window.location.href='index.html'">
                    ‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é
                </button>
                <button class="control-btn restart" onclick="confirmRestart()">
                    üîÑ –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ
                </button>
            </div>
            <!-- –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —É–¥–∞–ª—ë–Ω –∏–∑ —à–∞–ø–∫–∏ -->
        </div>
        
        <div class="map-container">
            <h1>–ö–∞—Ä—Ç–∞ –ö–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–∞ –°—Ç–µ–ø–µ–Ω–Ω–æ–π –ú–∞–≥–∏–∏</h1>
            <p id="levelDisplay" style="color: #FFD700; font-size: 1.2em;"></p>
            <p>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—Ä–æ–≤–∏–Ω—Ü–∏—é, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∏—Å–ø—ã—Ç–∞–Ω–∏–µ –Ω–∞ —Å–≤–æ–π—Å—Ç–≤–∞ —Å—Ç–µ–ø–µ–Ω–µ–π</p>
            
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
            <div class="progress-text" id="progressText">–ü—Ä–æ–≥—Ä–µ—Å—Å: 0/7</div>
            
            <div class="start-info" id="startInfo">
                <h3 style="color: #FFD700;">–ù–∞—á–Ω–∏—Ç–µ —Å –ø—Ä–æ–≤–∏–Ω—Ü–∏–∏ 1!</h3>
                <p>–ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è: <strong>1 ‚Üí 2 ‚Üí 3 ‚Üí 4 ‚Üí 5 ‚Üí 6 ‚Üí 7</strong></p>
                <div class="order-hint" id="orderHint"></div>
                <div class="power-law">
                    –ü–æ–º–Ω–∏—Ç–µ: a<sup>m</sup> √ó a<sup>n</sup> = a<sup>m+n</sup>
                </div>
                <p>–¢–µ–∫—É—â–∞—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –ø—Ä–æ–≤–∏–Ω—Ü–∏—è –ø–æ–¥—Å–≤–µ—á–µ–Ω–∞ –ø—É–ª—å—Å–∏—Ä—É—é—â–∏–º –∑–æ–ª–æ—Ç—ã–º —Å–≤–µ—Ç–æ–º</p>
            </div>
            
            <div class="paths-legend">
                <p>üìú <strong>–ó–æ–ª–æ—Ç—ã–µ –ª–∏–Ω–∏–∏</strong> –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤–∞—à –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π –ø—É—Ç—å –º–µ–∂–¥—É –ø—Ä–æ–≤–∏–Ω—Ü–∏—è–º–∏</p>
                <p>–õ–∏–Ω–∏–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –ø—Ä–æ–≤–∏–Ω—Ü–∏–π</p>
            </div>
            
            <div class="map-visual" id="mapVisual">
                <!-- –ü—É—Ç–∏ –º–µ–∂–¥—É –ø—Ä–æ–≤–∏–Ω—Ü–∏—è–º–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div id="completionMessage" class="completion-message">
                <h2 style="color: #2ecc71;">üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
                <p>–í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–ª–∏ –≤—Å–µ 7 –ø—Ä–æ–≤–∏–Ω—Ü–∏–π –∏ —Å—Ç–∞–ª–∏ –ú–∞—Å—Ç–µ—Ä–æ–º –°—Ç–µ–ø–µ–Ω–Ω–æ–π –ú–∞–≥–∏–∏!</p>
                <p>–í—ã –æ—Å–≤–æ–∏–ª–∏ –≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞ —Å—Ç–µ–ø–µ–Ω–µ–π:</p>
                <div style="text-align: left; margin: 15px 0;">
                    <div>‚úì –£–º–Ω–æ–∂–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–µ–π —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏—è–º–∏</div>
                    <div>‚úì –î–µ–ª–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–µ–π —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏—è–º–∏</div>
                    <div>‚úì –í–æ–∑–≤–µ–¥–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–∏ –≤ —Å—Ç–µ–ø–µ–Ω—å</div>
                    <div>‚úì –í–æ–∑–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∏ —á–∞—Å—Ç–Ω–æ–≥–æ –≤ —Å—Ç–µ–ø–µ–Ω—å</div>
                    <div>‚úì –£–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –¥–µ–ª–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–µ–π —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏</div>
                </div>
                <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
                    <button onclick="resetProgress()" style="padding: 10px 20px; background: #2ecc71; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ
                    </button>
                    <button onclick="window.location.href='index.html'" style="padding: 10px 20px; background: rgba(255, 255, 255, 0.1); color: white; border: 1px solid #FFD700; border-radius: 5px; cursor: pointer;">
                        –ù–∞ –≥–ª–∞–≤–Ω—É—é
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä level –∏–∑ URL
        const urlParams = new URLSearchParams(window.location.search);
        const level = urlParams.get('level') || 'easy';

        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —É—Ä–æ–≤–µ–Ω—å
        document.getElementById('levelDisplay').innerText = `–£—Ä–æ–≤–µ–Ω—å: ${level === 'hard' ? '–°–ª–æ–∂–Ω—ã–π' : '–õ—ë–≥–∫–∏–π'}`;

        // –ú–∞—Å—Å–∏–≤—ã –ø—Ä–æ–≤–∏–Ω—Ü–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è
        const easyProvinces = [
            { number: 1, operation: "+", x: 20, y: 50, description: "–°–ª–æ–∂–µ–Ω–∏–µ: a‚Åø √ó a·µê = a‚Åø‚Å∫·µê" },
            { number: 2, operation: "-", x: 40, y: 20, description: "–í—ã—á–∏—Ç–∞–Ω–∏–µ: a‚Åø √∑ a·µê = a‚Åø‚Åª·µê" },
            { number: 3, operation: "+", x: 60, y: 50, description: "–°—Ç–µ–ø–µ–Ω—å —Å—Ç–µ–ø–µ–Ω–∏: (a‚Åø)·µê = a‚Åø√ó·µê" },
            { number: 4, operation: "√ó", x: 80, y: 30, description: "–í–æ–∑–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è: (ab)‚Åø = a‚Åøb‚Åø" },
            { number: 5, operation: "√∑", x: 20, y: 80, description: "–í–æ–∑–≤–µ–¥–µ–Ω–∏–µ —á–∞—Å—Ç–Ω–æ–≥–æ: (a/b)‚Åø = a‚Åø/b‚Åø" },
            { number: 6, operation: "√ó", x: 40, y: 70, description: "–£–º–Ω–æ–∂–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–µ–π: a‚Åø √ó b‚Åø = (ab)‚Åø" },
            { number: 7, operation: "√∑", x: 60, y: 80, description: "–î–µ–ª–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–µ–π: a‚Åø √∑ b‚Åø = (a/b)‚Åø" }
        ];

        const hardProvinces = [
            { number: 1, operation: "+", x: 20, y: 50, description: "–°–ª–æ–∂–µ–Ω–∏–µ —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏" },
            { number: 2, operation: "-", x: 40, y: 20, description: "–î–µ–ª–µ–Ω–∏–µ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏" },
            { number: 3, operation: "+", x: 60, y: 50, description: "–í–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç–µ–ø–µ–Ω–∏ —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏" },
            { number: 4, operation: "√ó", x: 80, y: 30, description: "–ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç–µ–ø–µ–Ω–∏ —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏" },
            { number: 5, operation: "√∑", x: 20, y: 80, description: "–ß–∞—Å—Ç–Ω–æ–µ –≤ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏" },
            { number: 6, operation: "√ó", x: 40, y: 70, description: "–£–º–Ω–æ–∂–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–µ–π —Å –¥—Ä–æ–±–Ω—ã–º–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏—è–º–∏" },
            { number: 7, operation: "√∑", x: 60, y: 80, description: "–î–µ–ª–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–µ–π —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏" }
        ];

        const provinces = (level === 'hard') ? hardProvinces : easyProvinces;
        const order = [1, 2, 3, 4, 5, 6, 7];

        // –ö–ª—é—á –¥–ª—è localStorage
        const storageKey = `powerKingdomProgress_${level}`;
        let completed = JSON.parse(localStorage.getItem(storageKey)) || [];

        function initMap() {
            const mapVisual = document.getElementById('mapVisual');
            mapVisual.innerHTML = ''; // –æ—á–∏—â–∞–µ–º –ø–µ—Ä–µ–¥ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ–º

            provinces.forEach(province => {
                const provinceEl = document.createElement('div');
                provinceEl.className = 'province';
                provinceEl.id = `province${province.number}`;
                provinceEl.style.left = `${province.x}%`;
                provinceEl.style.top = `${province.y}%`;

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–æ–π–¥–µ–Ω–∞ –ª–∏ –ø—Ä–æ–≤–∏–Ω—Ü–∏—è
                if (completed.includes(province.number)) {
                    provinceEl.classList.add('completed');
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–µ–∫—É—â–µ–π (–¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è)
                const nextProvince = getNextProvince();
                if (province.number === nextProvince) {
                    provinceEl.classList.add('current');
                }

                // –ï—Å–ª–∏ –ø—Ä–æ–≤–∏–Ω—Ü–∏—è –µ—â—ë –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞ (–∏ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞), –±–ª–æ–∫–∏—Ä—É–µ–º –µ—ë
                if (!completed.includes(province.number) && province.number !== nextProvince) {
                    provinceEl.classList.add('locked');
                }

                provinceEl.innerHTML = `
                    <div class="province-number">${province.number}</div>
                    <div class="province-operation">${province.operation}</div>
                `;

                // –§–æ—Ä–º–∏—Ä—É–µ–º –∏–º—è —Ñ–∞–π–ª–∞ —Ç–µ—Å—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è
                const testFile = (level === 'hard') ? `test${province.number}_hard.html` : `test${province.number}.html`;

                provinceEl.onclick = () => {
                    const next = getNextProvince();
                    if (province.number === next) {
                        window.location.href = testFile + '?level=' + level; // –ø–µ—Ä–µ–¥–∞—ë–º —É—Ä–æ–≤–µ–Ω—å –¥–∞–ª—å—à–µ
                    } else if (completed.includes(province.number)) {
                        alert(`–í—ã —É–∂–µ –ø—Ä–æ—à–ª–∏ –ø—Ä–æ–≤–∏–Ω—Ü–∏—é ${province.number}: ${province.description}`);
                    } else {
                        alert(`–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–π–¥–∏—Ç–µ –ø—Ä–æ–≤–∏–Ω—Ü–∏—é ${next}! –ü–æ—Ä—è–¥–æ–∫: ${order.join(" ‚Üí ")}`);
                    }
                };

                provinceEl.title = `–ü—Ä–æ–≤–∏–Ω—Ü–∏—è ${province.number}: ${province.description}`;
                mapVisual.appendChild(provinceEl);
            });

            // –°–æ–∑–¥–∞—ë–º –ø—É—Ç–∏ –º–µ–∂–¥—É –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ–≤–∏–Ω—Ü–∏—è–º–∏
            //createPaths();

            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            updateProgress();
            updateOrderHint();

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏, –µ—Å–ª–∏ –ø—Ä–æ–π–¥–µ–Ω—ã –≤—Å–µ
            if (completed.length === 7) {
                document.getElementById('completionMessage').style.display = 'block';
                document.getElementById('startInfo').style.display = 'none';
            }
        }

        function createPaths() {
            const mapVisual = document.getElementById('mapVisual');
            // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –ø—É—Ç–∏
            document.querySelectorAll('.path').forEach(p => p.remove());

            // –°–æ–∑–¥–∞—ë–º –ø—É—Ç–∏ —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ–≤–∏–Ω—Ü–∏—è–º–∏
            for (let i = 0; i < completed.length - 1; i++) {
                const fromNum = completed[i];
                const toNum = completed[i + 1];
                const from = provinces.find(p => p.number === fromNum);
                const to = provinces.find(p => p.number === toNum);

                if (from && to) {
                    const path = document.createElement('div');
                    path.className = 'path visible';
                    path.id = `path${from.number}to${to.number}`;

                    const dx = to.x - from.x;
                    const dy = to.y - from.y;
                    const length = Math.sqrt(dx*dx + dy*dy);
                    const angle = Math.atan2(dy, dx) * 180 / Math.PI;

                    path.style.width = `${length}%`;
                    path.style.left = `${from.x}%`;
                    path.style.top = `${from.y}%`;
                    path.style.transform = `rotate(${angle}deg)`;

                    mapVisual.appendChild(path);
                }
            }
        }

        function getNextProvince() {
            if (completed.length >= order.length) return null;
            return order[completed.length];
        }

        function updateProgress() {
            const progress = document.getElementById('progress');
            const progressText = document.getElementById('progressText');
            const percent = (completed.length / 7) * 100;

            progress.style.width = `${percent}%`;
            progressText.textContent = `–ü—Ä–æ–≥—Ä–µ—Å—Å: ${completed.length}/7`;
        }

        function updateOrderHint() {
            const orderHint = document.getElementById('orderHint');
            orderHint.innerHTML = '';

            order.forEach((num, index) => {
                const step = document.createElement('div');
                step.className = 'order-step';

                if (index < completed.length) {
                    step.style.background = '#2ecc71';
                    step.textContent = '‚úì';
                } else if (index === completed.length) {
                    step.classList.add('current');
                    step.textContent = num;
                } else {
                    step.textContent = num;
                }

                orderHint.appendChild(step);
            });
        }

        function confirmRestart() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ? –í–µ—Å—å –≤–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç —É–¥–∞–ª—ë–Ω.')) {
                resetProgress();
            }
        }

        function resetProgress() {
            localStorage.removeItem(storageKey);
            completed = [];
            initMap(); // –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–∞—Ä—Ç—É –∑–∞–Ω–æ–≤–æ

            document.getElementById('completionMessage').style.display = 'none';
            document.getElementById('startInfo').style.display = 'block';

            showNotification('–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—à–µ–Ω! –ù–∞—á–Ω–∏—Ç–µ —Å –ø—Ä–æ–≤–∏–Ω—Ü–∏–∏ 1.', '#2ecc71');
        }

        function showNotification(message, color) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                left: 50%;
                transform: translateX(-50%);
                background: ${color};
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                z-index: 1000;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                animation: slideIn 0.5s, fadeOut 0.5s 2.5s;
            `;

            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { top: 50px; opacity: 0; }
                    to { top: 100px; opacity: 1; }
                }
                @keyframes fadeOut {
                    from { opacity: 1; }
                    to { opacity: 0; }
                }
            `;
            document.head.appendChild(style);

            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
                style.remove();
            }, 3000);
        }

        window.onload = initMap;
    </script>
</body>
</html>